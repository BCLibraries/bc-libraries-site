{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block pagestyles %}
<link rel="stylesheet" href="/theme/css/stories.css"/>
{% endblock %}

{% block content %}

{# temporary addition #}
{% include 'library-help-button.html' %}

{%include 'homepage/header.html' %}

<div id="main-body" role="main">
    <!-- DB RG BOX START -->
    <div class="container" id="db-rg-hours">
        <div class="row nobottom">
            {% include 'homepage/quick-links-new.html' %}

            {% include 'homepage/start-research.html' %}

            {% include 'homepage/story-box.html' %}
        </div>
    </div>
    <!-- DB RG HOURS BOX END -->

    {% include 'homepage/news-row.html' %}

    {% include 'homepage/digital-scholarship-highlight.html' %}

    {% include 'homepage/scholarship-at-bc.html' %}

    {% include 'homepage/exhibits-highlight.html' %}

    {% include 'homepage/facpub-highlight.html' %}

    {% include 'homepage/special-collections-highlight.html' %}
</div>
<!--
    Temporary location for inactive scripts
-->

<!--script type="text/javascript" src="/theme/js/libraryinfo.js"></script-->

<!-- /#contentinfo -->
<!-- MEGA MENU SCRIPT -->
<!--script type="text/javascript" src="/theme/js/megamenu.js"></script-->

<!-- Control search tab switch. -->
<!--script>
$(function () {
    $('#block_search *[role=presentation]').click(
        function() {
            var current_text = $('#block_search .tab-pane.active input[type=text]').val();
            $('#block_search .tab-pane input[type=text]').val(current_text);
        }
    );
});
</script-->

<!-- Script to block spam-bots. Requires JQuery. -->

<!-- JS for expanding search bar
<script src="/theme/js/classie.js"></script>
<script src="/theme/js/uisearch.js"></script>
<script>
    new UISearch( document.getElementById( 'sb-search' ) );
</script>-->

{% endblock %}

{% block pagescripts %}
<!-- master -->
<script type="text/javascript" src="/theme/js/story-box.js"></script>
<script type="text/javascript" src="/theme/bcbento/js/typeahead.bundle.min.js"></script>
<script type="text/javascript" src="/theme/bcbento/js/bclib-typeahead.js"></script>
<script type="text/javascript">
    // Various glue scripts for the front page.
    (function () {
        function run_on_ready(fn) {
            if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                fn();
            } else {
                document.addEventListener('DOMContentLoaded', fn);
            }
        }

        function listenForTypeahead() {
            $('#search-panel').on('typeahead:selected', function (evt, data) {
                $('#search-panel form').submit();
            });
        }

        /* Rewrote makeQuickLinkBoxesClickable to use jQuery methods. */
        /* Fixes IE/Edge issue with forEach() not supporting nodeList */

        /* object returned from document.querySelectorAll */
        function makeQuickLinkBoxesClickable() {
            $(".quick-link-block").click(function (evt) {
                window.location = $(this).find("a").attr("href");
            });
        }

        function smartLinkToSearch() {
            var host = window.location.host === 'libdev.bc.edu' ? 'bcprimo-test.hosted.exlibrisgroup.com' : 'bc-primo.hosted.exlibrisgroup.com';

            var book_search_url = 'https://' + host + '/primo-explore/search?tab=bcl_only&search_scope=bcl&vid=bclib_new&lang=en_US&offset=0',
                article_search_url = 'https://' + host + '/primo-explore/search?tab=pci_only&search_scope=pci&vid=bclib_new&lang=en_US&offset=0',
                journal_search_url = 'https://' + host + '/primo-explore/jsearch?tab=jsearch_slot&vid=bclib_new&lang=en_US&offset=0';

            linkToSearch('.book-search-link', book_search_url);
            linkToSearch('.article-search-link', article_search_url);
            linkToSearch('.journal-search-link', journal_search_url, 'journals=any,~~TERM~~');
        }

        function linkToSearch(link_class, base_url, additional_search_param) {
            $(link_class).click(function (e) {
                var term = $('#lib-search-box').val();
                if (term) {
                    base_url = base_url + '&query=any,contains,~~TERM~~';
                    if (additional_search_param) {
                        base_url = base_url + '&' + additional_search_param
                    }
                }
                e.preventDefault();
                window.location.href = base_url.replace(/~~TERM~~/g, term);
                return false;
            });
        }

        run_on_ready(smartLinkToSearch());
        run_on_ready(listenForTypeahead);
        run_on_ready(makeQuickLinkBoxesClickable);
    })();
</script>
{% endblock %}
